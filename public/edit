#!/usr/bin/env bash
echo Editing $1..
if test -f $1
then
	if [[ $(file -b --mime-type $1) == "text/html" && $1 == *.html ]]
	then
		blog-helper remove-polish $1 > temp$1.html
		rm $1
		pandoc -o temp$1.md temp$1.html
		rm temp$1.html
		$EDITOR temp$1.md
		pandoc -o $1 temp$1.md
		rm temp$1.md
		#spell check
		aspell -c $1
		#remove .bak file generated by aspell
		rm $1.bak
		#blog-helper related commands
		blog-helper add-polish $1
		#add to git, commit and push if user wants to push
		git add $1
		git commit
		echo WARNING! You are about to update an article for the whole world to read!!
		echo Press Ctrl+C to ABORT IF YOU NEED TO! THIS IS THE POINT OF NO RETURN
		echo Waiting 10 seconds..
		sleep 10
		echo PUSHING TO ORIGIN, this will publish the article
		git push origin
	fi
fi
