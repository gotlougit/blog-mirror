#!/usr/bin/env bash
echo Running blogpost checks...
files=$(git ls-files --others --exclude-standard)

for f in $files
do
	if test -f $f
	then
		if [[ $(file -b --mime-type $f) == "text/html" && $f == *.html ]]
		then
			#spell check
			aspell -c $f
			#remove .bak file generated by aspell
			trash-rm $f.bak
			#blog-helper related commands
			blog-helper add-polish $f
			blog-helper add-entry $f
			#add to git, commit and push if user wants to push
			git add index.html $f
			git commit
			echo WARNING! You are about to publish an article for the whole world to read!!
			echo Press Ctrl+C to ABORT IF YOU NEED TO! THIS IS THE POINT OF NO RETURN
			echo Waiting 10 seconds..
			sleep 10
			echo PUSHING TO ORIGIN, this will publish the article
			git push origin
		fi
	fi
done
